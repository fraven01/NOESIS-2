<p class="max-w-2xl text-sm text-slate-600">
  Developer tool to test the <code class="rounded bg-slate-100 px-1 py-0.5 text-xs">/v1/ai/frameworks/analyze/</code>
  endpoint.
  Analyzes a document to extract framework structures.
</p>
</header>

<section class="rounded-lg border border-slate-200 bg-white p-6 shadow-sm space-y-6">
  <div class="space-y-2">
    <h2 class="text-xl font-semibold text-slate-900">Analysis Request</h2>
    <p class="text-sm text-slate-600">
      Configure the analysis parameters.
      Tenant: <code class="rounded bg-slate-100 px-1 py-0.5 text-xs">{{ tenant_id }}</code>
      Schema: <code class="rounded bg-slate-100 px-1 py-0.5 text-xs">{{ tenant_schema }}</code>
    </p>
  </div>

  <form id="analysis-form" class="grid gap-4 md:grid-cols-2" hx-post="{% url 'framework-analysis-submit' %}"
    hx-target="#response-output" hx-swap="innerHTML"
    hx-headers='{"X-Tenant-ID": "{{ tenant_id }}", "X-Tenant-Schema": "{{ tenant_schema }}"}'
    hx-indicator="#submit-button" hx-disabled-elt="#submit-button">
    {% csrf_token %}

    <div class="space-y-1">
      <label class="text-sm font-medium text-slate-700" for="collection-id">Document Collection ID</label>
      <input
        class="block w-full rounded-md border border-slate-300 px-3 py-2 text-sm shadow-sm focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500"
        id="collection-id" name="document_collection_id" type="text" value="{{ default_collection_id|default:'' }}"
        placeholder="UUID" required />
      <p class="text-xs text-slate-500">The ID of the document collection containing the document.</p>
    </div>

    <div class="space-y-1">
      <label class="text-sm font-medium text-slate-700" for="document-id">Document ID (Optional)</label>
      <input
        class="block w-full rounded-md border border-slate-300 px-3 py-2 text-sm shadow-sm focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500"
        id="document-id" name="document_id" type="text" placeholder="UUID" />
      <p class="text-xs text-slate-500">Specific document to analyze. If omitted, behavior depends on backend.</p>
    </div>

    <div class="space-y-1">
      <label class="text-sm font-medium text-slate-700" for="confidence-threshold">Confidence Threshold</label>
      <input
        class="block w-full rounded-md border border-slate-300 px-3 py-2 text-sm shadow-sm focus:border-slate-500 focus:outline-none focus:ring-1 focus:ring-slate-500"
        id="confidence-threshold" name="confidence_threshold" type="number" step="0.05" min="0" max="1" value="0.70" />
    </div>

    <div class="md:col-span-2 space-y-2">
      <label class="inline-flex items-center gap-2 text-sm text-slate-700" for="force-reanalysis">
        <input type="checkbox" id="force-reanalysis" name="force_reanalysis"
          class="h-4 w-4 rounded border-slate-300 text-slate-900 focus:ring-slate-500" />
        Force Reanalysis
      </label>
      <p class="text-xs text-slate-500">If checked, ignores existing analysis and re-runs the process.</p>
    </div>

    <div class="md:col-span-2">
      <button
        class="inline-flex items-center rounded-md bg-slate-900 px-4 py-2 text-sm font-medium text-white shadow-sm transition hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-slate-500 focus:ring-offset-2 disabled:opacity-75 disabled:cursor-not-allowed"
        type="submit" id="submit-button">
        Start Analysis
      </button>
    </div>
  </form>

  <div class="space-y-2">
    <div class="flex items-center justify-between">
      <h3 class="text-sm font-semibold uppercase tracking-wide text-slate-600">Response</h3>
    </div>
    <div id="response-output">
      <pre
        class="max-h-[600px] overflow-auto rounded-lg bg-slate-950 p-4 text-slate-100 text-xs">// Response will appear here...</pre>
    </div>
  </div>
</section>
</div>
{% endblock %}